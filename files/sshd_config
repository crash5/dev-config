#ssh-keygen -lf /etc/ssh/rsa_key.pub
#
#ssh-keygen -t rsa -b 4096 -N '' -f /etc/ssh/ssh_host_rsa_key
#ssh-keygen -o -t ed25519 -N '' -f /etc/ssh/ssh_host_ed25519_key
#
#ssh-keygen -G moduli-2048.candidates -b 2048
#sudo ssh-keygen -T /etc/ssh/moduli -f moduli-2048.candidates

Port 22

Protocol 2

DebianBanner no

HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
KexAlgorithms curve25519-sha256@libssh.org


PermitRootLogin no
PermitEmptyPasswords no
PasswordAuthentication no
ChallengeResponseAuthentication no
UsePAM yes
HostbasedAuthentication no

MaxAuthTries 3
LoginGraceTime 30s

AuthenticationMethods publickey
PubkeyAuthentication yes
AllowGroups allow_ssh

AllowTcpForwarding yes
X11Forwarding no
IgnoreRhosts yes

AcceptEnv LANG LC_*

PrintMotd no


Subsystem sftp /usr/lib/openssh/sftp-server

#Match Group sftponly
#    ChrootDirectory /home/%u
#    ForceCommand internal-sftp
#    AllowTcpForwarding no
#    X11Forwarding no
